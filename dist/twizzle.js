!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("twisty"),require("puzzle-geometry"),require("alg"),require("kpuzzle")):"function"==typeof define&&define.amd?define(["twisty","puzzle-geometry","alg","kpuzzle"],t):"object"==typeof exports?exports.twizzle=t(require("twisty"),require("puzzle-geometry"),require("alg"),require("kpuzzle")):e.twizzle=t(e.twisty,e["puzzle-geometry"],e.alg,e.kpuzzle)}("undefined"!=typeof self?self:this,function(e,t,n,r){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t,n){"use strict";var r,o,l,i,s,a,u,c,d=n(0),p=n(1),f=n(2),v=n(3),m="",g="",y="",z=0,h=["threed","centers","edges","corners","centers","edges","corners","blockmoves","vertexmoves"],b=["centers","edges","corners","optimize","blockmoves","allmoves","vertexmoves","killori"];function w(e){return document.getElementById(e).checked}function x(e){for(var t={},n=0;n<e.length;n++)t[e[n]]=w(e[n]);return t}function k(e){var t=document.getElementById("svg");if(!t||!e)return!1;e.stopPropagation(),e.preventDefault();var n=t.createSVGPoint();n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(t.getScreenCTM().inverse());for(var r=1e6,o=void 0,i=0;i<l.length;i++){var a=Math.hypot(l[i][0]-n.x,l[i][1]-n.y);a<r&&(r=a,o=i)}if(void 0!=o){var u=l[o][2];e.shiftKey?u=w("blockmoves")?u.toLowerCase():"2"+u:(e.ctrlKey||e.metaKey)&&c[u]&&(u=""+c[u]+u.toLowerCase()),function(e,t){try{var n=Object(f.parse)(s.value),r=Object(f.parse)(e);if(n instanceof f.Sequence&&r instanceof f.Sequence&&1==r.nestedUnits.length&&n.nestedUnits.length>0){var o=n.nestedUnits[n.nestedUnits.length-1],l=r.nestedUnits[0];if(o instanceof f.SiGNMove&&l instanceof f.SiGNMove&&o.family==l.family&&o.outerLayer==l.outerLayer&&o.innerLayer==l.innerLayer){var i=l.amount+o.amount,a=n.nestedUnits.slice();if(0==i||t>0&&i%t==0)a.length-=1;else{for(;i+i>t;)i-=t;for(;i+i<=-t;)i+=t;a[n.nestedUnits.length-1]=new f.SiGNMove(o.outerLayer,o.innerLayer,o.family,i)}return s.value=Object(f.algToString)(new f.Sequence(a)),void C()}}}catch(e){}s.value+=" "+e,C()}(u+(3==e.which?"":"'"),l[o][3])}return!1}function S(){var e=document.getElementById("svg");e&&!e.onclick&&(e.onclick=function(e){return k(e)}),e&&!e.oncontextmenu&&(e.oncontextmenu=function(e){return k(e)})}function j(e,t){return e.trim()==t.trim()}function E(e,t){var n;0==e.trim().length?(n=Object(f.parse)(o[0]+"60"),e=""):(n=Object(f.parse)(e),e=Object(f.algToString)(n));var l=document.querySelector("#custom-example");l&&(l.textContent="",new d.Twisty(l,{puzzle:r,alg:n}).anim.skipToEnd(),t&&(s.value=e,y=e))}function I(e){var t=window.open("","_blank");t&&(t.document.open("text/plain","replace"),t.document.write("<pre>"),e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),t.document.write(e),t.document.write("</pre>"),t.document.close())}function P(){var e=window.open("","_blank");if(e)return e.document.open("text/plain","replace"),e.document.write("<pre>"),function(t){t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),e&&e.document&&e.document.write(t+"\n")};throw"Could not open window"}function O(e){if("scramble"==e)return z=1,void C();if("reset"==e)return z=-1,void C();if("help"!=e)if("options"!=e){var t=[],n=x(b);n.allmoves&&t.push("allmoves",!0),n.vertexmoves&&t.push("vertexmoves",!0),n.corners||t.push("cornersets",!1),n.edges||t.push("edgesets",!1),n.centers||t.push("centersets",!1),n.optimize&&t.push("optimize",!0),n.blockmoves&&t.push("outerblockmoves",!0),n.killori&&t.push("killorientation",!0);var r=p.PuzzleGeometry.parsedesc(i.value),o=new p.PuzzleGeometry(r[0],r[1],t);if(o.allstickers(),o.genperms(),"gap"==e)I(o.writegap());else if("ss"==e){var l=P(),s=o.getOrbitsDef(!1).reassemblySize();l("Reassembly size is "+s),l("Ratio is "+s/p.SchreierSims.schreiersims(o.getMovesAsPerms(),l))}else"canon"==e?o.showcanon(P()):"ksolve"==e?I(o.writeksolve("TwizzlePuzzle",!1)):"svgcmd"==e?I(o.generatesvg(800,500,10,w("threed"))):alert("Command "+e+" not handled yet.")}else{var a=document.getElementById("optionsspan"),u=document.getElementById("data");a&&u&&("none"!=a.style.display?(a.style.display="none",u.style.display="none"):(a.style.display="inline",u.style.display="inline"))}else window.open("Help.html","Twizzle Help")}function C(){S();var e=i.value;if(null!=e){var t=s.value;if(null!=t){var n=x(h),a=j(e,g)&&function(e,t,n){for(var r=0;r<e.length;r++)if(t[e[r]]!=n[e[r]])return!1;return!0}(h,u,n);if(0!=z||!j(t,y)||!a){if(0!=z||g!=e||!a){var d=!0;g=e,u=n;var f=p.PuzzleGeometry.parsedesc(e);if(f){var b=["allmoves",!0];u.corners||b.push("cornersets",!1),u.edges||b.push("edgesets",!1),u.centers||b.push("centersets",!1),0!=z&&(z>0&&b.push("scramble",1),z=0,t="",m="",d=!1);var w=new p.PuzzleGeometry(f[0],f[1],b);w.allstickers(),w.genperms();var k,I="Faces "+w.baseplanerot.length+"\nStickers per face "+w.stickersperface+"\nCubies "+w.cubies.length+"\nShort edge "+w.shortedge+"\nEdge distance "+w.edgedistance+"\nVertex distance "+w.vertexdistance,P=document.getElementById("data");P&&(P.title=I),a&&""!=m?k=m:(k=w.writeksolve("TwizzlePuzzle",!0),o=w.ksolvemovenames);var O=w.generatesvg(800,500,10,u.threed);l=w.svggrips,function(e,t,n,o){m=t,r=Object(v.parse)(t);var l=e.movesetgeos,i=new v.KPuzzle(r);i.setFaceNames(e.facenames.map(e=>e[1])),c={};for(var a=0;a<l.length;a++){var u=l[a][0],d=l[a][2];i.addGrip(u,d,l[a][4]),c[u]=l[a][4],c[d]=l[a][4]}if(r.svg=n,s.style.backgroundColor="",o&&!j(y,""))try{E(y,!0)}catch(e){console.log("Could not parse "+y),s.style.backgroundColor="#ff8080"}else E("",!0);S()}(w,k,O,d)}d||(y="",t=s.value)}if(!j(y,t)){y=t,s.style.backgroundColor="";var C="";if(C=t.trim().length>0?t:"",r)try{E(C,!1)}catch(e){return console.log("Could not parse "+C),void(s.style.backgroundColor="#ff8080")}}}}}}function q(e){var t=e.target.value;""!=t&&(a.selectedIndex=0,O(t))}function T(e){""!=e.target.value&&(i.value=e.target.value,C())}function B(e){var t=window.location.search,n=new RegExp("[&?]"+e+"=([^&#]*)").exec(t);return n&&n[1]?decodeURIComponent(n[1].replace(/\+/g," ")):""}function M(){var e=document.getElementById("puzzleoptions");i=document.getElementById("desc"),s=document.getElementById("algorithm");var t=p.PuzzleGeometry.getpuzzles();u=x(h);for(var n=B("puzzle"),r=B("puzzlegeometry"),o=!1,l=0;l<t.length;l+=2){var c=document.createElement("option");c.value=t[l],c.innerHTML=t[l+1],""==r&&n==t[l+1]&&(c.selected=!0,i.value=t[l],o=!0),e.add(c)}if(""!=r)e.selectedIndex=0,i.value=r;else if(!o)for(l=0;l<t.length;l+=2)"3x3x3"==t[l+1]&&(e.selectedIndex=1+l/2,i.value=t[l]);e.onchange=T,(a=document.getElementById("action")).onchange=q;var d=["scramble","help","reset","options"];for(l=0;l<d.length;l++)document.getElementById(d[l]).onclick=function(e){return function(){O(e)}}(d[l]);var f=B("alg");""!=(f=function(e){return e.replace(/-/g,"'").replace(/_/g," ")}(f))&&(s.value=f,y=f),C(),setInterval(C,.5)}window.addEventListener("load",M),n.d(t,"setup",function(){return M})}])});
//# sourceMappingURL=twizzle.js.map