!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("twisty"),require("puzzle-geometry"),require("alg"),require("kpuzzle")):"function"==typeof define&&define.amd?define(["twisty","puzzle-geometry","alg","kpuzzle"],t):"object"==typeof exports?exports.twizzle=t(require("twisty"),require("puzzle-geometry"),require("alg"),require("kpuzzle")):e.twizzle=t(e.twisty,e["puzzle-geometry"],e.alg,e.kpuzzle)}("undefined"!=typeof self?self:this,function(e,t,n,r){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t,n){"use strict";var r,o,l,i,s,a,u,c,d=n(0),f=n(1),p=n(2),v=n(3),m="",g="",y="",h=0,z=["threed","centers","edges","corners","centers","edges","corners","blockmoves","vertexmoves"],b=["centers","edges","corners","optimize","blockmoves","allmoves","vertexmoves","killori"];function w(e){return document.getElementById(e).checked}function x(e){for(var t={},n=0;n<e.length;n++)t[e[n]]=w(e[n]);return t}function k(){s.scrollLeft=s.scrollWidth,s.focus(),s.selectionStart=s.selectionEnd=1e8}function S(e){var t=document.getElementById("svg");if(!t||!e)return!1;e.stopPropagation(),e.preventDefault();var n=t.createSVGPoint();n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(t.getScreenCTM().inverse());for(var r=1e6,o=void 0,i=0;i<l.length;i++){var a=Math.hypot(l[i][0]-n.x,l[i][1]-n.y);a<r&&(r=a,o=i)}if(void 0!=o){var u=l[o][2];e.shiftKey?u=w("blockmoves")?u.toLowerCase():"2"+u:(e.ctrlKey||e.metaKey)&&c[u]&&(u=""+c[u]+u.toLowerCase()),function(e,t){try{var n=Object(p.parse)(s.value),r=Object(p.parse)(e);if(n instanceof p.Sequence&&r instanceof p.Sequence&&1==r.nestedUnits.length&&n.nestedUnits.length>0){var o=n.nestedUnits[n.nestedUnits.length-1],l=r.nestedUnits[0];if(o instanceof p.SiGNMove&&l instanceof p.SiGNMove&&o.family==l.family&&o.outerLayer==l.outerLayer&&o.innerLayer==l.innerLayer){var i=l.amount+o.amount,a=n.nestedUnits.slice();if(0==i||t>0&&i%t==0)a.length-=1;else{for(;i+i>t;)i-=t;for(;i+i<=-t;)i+=t;a[n.nestedUnits.length-1]=new p.SiGNMove(o.outerLayer,o.innerLayer,o.family,i)}return s.value=Object(p.algToString)(new p.Sequence(a)),k(),void q()}}}catch(e){}s.value+=" "+e,k(),q()}(u+(3==e.which?"":"'"),l[o][3])}return!1}function j(){var e=document.getElementById("svg");e&&!e.onclick&&(e.onclick=function(e){return S(e)}),e&&!e.oncontextmenu&&(e.oncontextmenu=function(e){return S(e)})}function P(e,t){return e.trim()==t.trim()}function E(e,t){var n;0==e.trim().length?(n=Object(p.parse)(o[0]+"60"),e=""):(n=Object(p.parse)(e),e=Object(p.algToString)(n));var l=document.querySelector("#custom-example");l&&(l.textContent="",new d.Twisty(l,{puzzle:r,alg:n}).anim.skipToEnd(),t&&(s.value=e,y=e))}function O(e){var t=window.open("","_blank");t&&(t.document.open("text/plain","replace"),t.document.write("<pre>"),e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),t.document.write(e),t.document.write("</pre>"),t.document.close())}function C(){var e=window.open("","_blank");if(e)return e.document.open("text/plain","replace"),e.document.write("<pre>"),function(t){t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),e&&e.document&&e.document.write(t+"\n")};throw"Could not open window"}function I(e){if("scramble"==e)return h=1,void q();if("reset"==e)return h=-1,void q();if("help"!=e){var t=[],n=x(b);n.allmoves&&t.push("allmoves",!0),n.vertexmoves&&t.push("vertexmoves",!0),n.corners||t.push("cornersets",!1),n.edges||t.push("edgesets",!1),n.centers||t.push("centersets",!1),n.optimize&&t.push("optimize",!0),n.blockmoves&&t.push("outerblockmoves",!0),n.killori&&t.push("killorientation",!0);var r=f.PuzzleGeometry.parsedesc(i.value),o=new f.PuzzleGeometry(r[0],r[1],t);if(o.allstickers(),o.genperms(),"gap"==e)O(o.writegap());else if("ss"==e){var l=C(),s=o.getOrbitsDef(!1).reassemblySize();l("Reassembly size is "+s),l("Ratio is "+s/f.SchreierSims.schreiersims(o.getMovesAsPerms(),l))}else"canon"==e?o.showcanon(C()):"ksolve"==e?O(o.writeksolve("TwizzlePuzzle",!1)):"svgcmd"==e?O(o.generatesvg(800,500,10,w("threed"))):alert("Command "+e+" not handled yet.")}else window.open("Help.html","Twizzle Help")}function q(){j();var e=i.value;if(null!=e){var t=s.value;if(null!=t){var n=x(z),a=P(e,g)&&function(e,t,n){for(var r=0;r<e.length;r++)if(t[e[r]]!=n[e[r]])return!1;return!0}(z,u,n);if(0!=h||!P(t,y)||!a){if(0!=h||g!=e||!a){var d=!0;g=e,u=n;var p=f.PuzzleGeometry.parsedesc(e);if(p){var b=["allmoves",!0];u.corners||b.push("cornersets",!1),u.edges||b.push("edgesets",!1),u.centers||b.push("centersets",!1),0!=h&&(h>0&&b.push("scramble",1),h=0,t="",m="",d=!1);var w=new f.PuzzleGeometry(p[0],p[1],b);w.allstickers(),w.genperms();var k,S="Faces "+w.baseplanerot.length+"\nStickers per face "+w.stickersperface+"\nCubies "+w.cubies.length+"\nShort edge "+w.shortedge+"\nEdge distance "+w.edgedistance+"\nVertex distance "+w.vertexdistance,O=document.getElementById("data");O&&(O.title=S),a&&""!=m?k=m:(k=w.writeksolve("TwizzlePuzzle",!0),o=w.ksolvemovenames);var C=w.generatesvg(800,500,10,u.threed);l=w.svggrips,function(e,t,n,o){m=t,r=Object(v.parse)(t);var l=e.movesetgeos,i=new v.KPuzzle(r);i.setFaceNames(e.facenames.map(e=>e[1])),c={};for(var a=0;a<l.length;a++){var u=l[a][0],d=l[a][2];i.addGrip(u,d,l[a][4]),c[u]=l[a][4],c[d]=l[a][4]}if(r.svg=n,s.style.backgroundColor="",o&&!P(y,""))try{E(y,!0)}catch(e){console.log("Could not parse "+y),s.style.backgroundColor="#ff8080"}else E("",!0);j()}(w,k,C,d)}d||(y="",t=s.value)}if(!P(y,t)){y=t,s.style.backgroundColor="";var I="";if(I=t.trim().length>0?t:"",r)try{E(I,!1)}catch(e){return console.log("Could not parse "+I),void(s.style.backgroundColor="#ff8080")}}}}}}function T(e){var t=e.target.value;""!=t&&(a.selectedIndex=0,I(t))}function L(e){""!=e.target.value&&(i.value=e.target.value,q())}function M(e){var t=window.location.search,n=new RegExp("[&?]"+e+"=([^&#]*)").exec(t);return n&&n[1]?decodeURIComponent(n[1].replace(/\+/g," ")):""}function G(){var e=document.getElementById("puzzleoptions");i=document.getElementById("desc"),s=document.getElementById("algorithm");var t=f.PuzzleGeometry.getpuzzles();u=x(z);for(var n=M("puzzle"),r=M("puzzlegeometry"),o=!1,l=0;l<t.length;l+=2){var c=document.createElement("option");c.value=t[l],c.innerHTML=t[l+1],""==r&&n==t[l+1]&&(c.selected=!0,i.value=t[l],o=!0),e.add(c)}if(""!=r)e.selectedIndex=0,i.value=r;else if(!o)for(l=0;l<t.length;l+=2)"3x3x3"==t[l+1]&&(e.selectedIndex=1+l/2,i.value=t[l]);e.onchange=L,(a=document.getElementById("action")).onchange=T;var d=["scramble","help","reset"];for(l=0;l<d.length;l++)document.getElementById(d[l]).onclick=function(e){return function(){I(e)}}(d[l]);var p=M("alg");""!=p&&(s.value=p,y=p),q(),setInterval(q,.5)}window.addEventListener("load",G),n.d(t,"setup",function(){return G})}])});
//# sourceMappingURL=twizzle.js.map