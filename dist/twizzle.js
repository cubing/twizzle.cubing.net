!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("twisty"),require("puzzle-geometry"),require("alg"),require("kpuzzle")):"function"==typeof define&&define.amd?define(["twisty","puzzle-geometry","alg","kpuzzle"],t):"object"==typeof exports?exports.twizzle=t(require("twisty"),require("puzzle-geometry"),require("alg"),require("kpuzzle")):e.twizzle=t(e.twisty,e["puzzle-geometry"],e.alg,e.kpuzzle)}("undefined"!=typeof self?self:this,function(e,t,n,r){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t,n){"use strict";var r,o,i,s,l,a,u,c=n(0),d=n(1),f=n(2),p=n(3),v="",m="",g="",y=!1,z=["threed","centers","edges","corners","centers","edges","corners","blockmoves","vertexmoves"],h=["centers","edges","corners","optimize","blockmoves","allmoves","vertexmoves","killori"];function b(e){return document.getElementById(e).checked}function w(e){for(var t={},n=0;n<e.length;n++)t[e[n]]=b(e[n]);return t}function k(){l.scrollLeft=l.scrollWidth,l.focus(),l.selectionStart=l.selectionEnd=1e8}function x(e){var t=document.getElementById("svg");if(!t||!e)return!1;e.stopPropagation(),e.preventDefault();var n=t.createSVGPoint();n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(t.getScreenCTM().inverse());for(var r=1e6,o=void 0,s=0;s<i.length;s++){var a=Math.hypot(i[s][0]-n.x,i[s][1]-n.y);a<r&&(r=a,o=s)}if(void 0!=o){var c=i[o][2];e.shiftKey?c=b("blockmoves")?c.toLowerCase():"2"+c:(e.ctrlKey||e.metaKey)&&u[c]&&(c=""+u[c]+c.toLowerCase()),function(e,t){try{var n=Object(f.parse)(l.value),r=Object(f.parse)(e);if(n instanceof f.Sequence&&r instanceof f.Sequence&&1==r.nestedUnits.length&&n.nestedUnits.length>0){var o=n.nestedUnits[n.nestedUnits.length-1],i=r.nestedUnits[0];if(o instanceof f.SiGNMove&&i instanceof f.SiGNMove&&o.family==i.family&&o.outerLayer==i.outerLayer&&o.innerLayer==i.innerLayer){var s=i.amount+o.amount,a=n.nestedUnits.slice();if(0==s||t>0&&s%t==0)a.length-=1;else{for(;s+s>t;)s-=t;for(;s+s<=-t;)s+=t;a[n.nestedUnits.length-1]=new f.SiGNMove(o.outerLayer,o.innerLayer,o.family,s)}return l.value=Object(f.algToString)(new f.Sequence(a)),k(),void q()}}}catch(e){}l.value+=" "+e,k(),q()}(c+(3==e.which?"":"'"),i[o][3])}return!1}function S(){var e=document.getElementById("svg");e&&!e.onclick&&(e.onclick=function(e){return x(e)}),e&&!e.oncontextmenu&&(e.oncontextmenu=function(e){return x(e)})}function j(e,t){return e.trim()==t.trim()}function P(e,t){var n;0==e.trim().length?(n=Object(f.parse)(o[0]+"60"),e=""):(n=Object(f.parse)(e),e=Object(f.algToString)(n));var i=document.querySelector("#custom-example");i&&(i.textContent="",new c.Twisty(i,{puzzle:r,alg:n}).anim.skipToEnd(),t&&(l.value=e,g=e))}function O(e){var t=window.open("","_blank");t&&(t.document.open("text/plain","replace"),t.document.write("<pre>"),e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),t.document.write(e),t.document.write("</pre>"),t.document.close())}function B(){var e=window.open("","_blank");if(e)return e.document.open("text/plain","replace"),e.document.write("<pre>"),function(t){t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),e&&e.document&&e.document.write(t+"\n")};throw"Could not open window"}function E(e){if("scramble"==e)return y=!0,void q();var t=[],n=w(h);n.allmoves&&t.push("allmoves",!0),n.vertexmoves&&t.push("vertexmoves",!0),n.corners||t.push("cornersets",!1),n.edges||t.push("edgesets",!1),n.centers||t.push("centersets",!1),n.optimize&&t.push("optimize",!0),n.blockmoves&&t.push("outerblockmoves",!0),n.killori&&t.push("killorientation",!0);var r=d.PuzzleGeometry.parsedesc(s.value),o=new d.PuzzleGeometry(r[0],r[1],t);if(o.allstickers(),o.genperms(),"gap"==e)O(o.writegap());else if("ss"==e){var i=B(),l=o.getOrbitsDef(!1).reassemblySize();i("Reassembly size is "+l),i("Ratio is "+l/d.SchreierSims.schreiersims(o.getMovesAsPerms(),i))}else"canon"==e?o.showcanon(B()):"ksolve"==e?O(o.writeksolve("TwizzlePuzzle",!1)):"svgcmd"==e?O(o.generatesvg(800,500,10,b("threed"))):alert("Command "+e+" not handled yet.")}function q(){S();var e=s.value;if(null!=e){var t=l.value;if(null!=t){var n=w(z),c=function(e,t,n){for(var r=0;r<e.length;r++)if(t[e[r]]!=n[e[r]])return!1;return!0}(z,a,n);if(y||!j(e,m)||!j(t,g)||!c){if(y||m!=e||!c){var f=j(m,e);m=e,a=n;var h=d.PuzzleGeometry.parsedesc(e);if(h){var b=["allmoves",!0];a.corners||b.push("cornersets",!1),a.edges||b.push("edgesets",!1),a.centers||b.push("centersets",!1),y&&(b.push("scramble",1),y=!1,t="",v="",f=!1);var k=new d.PuzzleGeometry(h[0],h[1],b);k.allstickers(),k.genperms();var x,O="Faces "+k.baseplanerot.length+"<BR>Stickers per face "+k.stickersperface+"<BR>Cubies "+k.cubies.length+"<BR>Short edge "+k.shortedge+"<BR>Edge distance "+k.edgedistance+"<BR>Vertex distance "+k.vertexdistance+"<BR>",B=document.getElementById("data");B&&(B.innerHTML=O),c&&f&&""!=v?x=v:(x=k.writeksolve("TwizzlePuzzle",!0),o=k.ksolvemovenames);var E=k.generatesvg(800,500,10,a.threed);i=k.svggrips,function(e,t,n,o){v=t,r=Object(p.parse)(t);var i=e.movesetgeos,s=new p.KPuzzle(r);s.setFaceNames(e.facenames.map(e=>e[1])),u={};for(var l=0;l<i.length;l++){var a=i[l][0],c=i[l][2];s.addGrip(a,c,i[l][4]),u[a]=i[l][4],u[c]=i[l][4]}r.svg=n,o&&!j(g,"")?P(g,!0):P("",!0),S()}(k,x,E,f)}f||(g="",t=l.value)}if(!j(g,t)){g=t,l.style.backgroundColor="";var q="";if(q=t.trim().length>0?t:"",r)try{P(q,!1)}catch(e){return console.log("Could not parse "+q),void(l.style.backgroundColor="#ff8080")}}}}}}function L(e){""!=e.target.value&&(s.value=e.target.value,q())}function M(){var e=document.getElementById("puzzleoptions");s=document.getElementById("desc"),l=document.getElementById("algorithm");var t=d.PuzzleGeometry.getpuzzles();a=w(z);for(var n=0;n<t.length;n+=2){var r=document.createElement("option");r.value=t[n],r.innerHTML=t[n+1],e.add(r)}e.onchange=L;var o=["ss","ksolve","gap","canon","export","svgcmd","scramble"];for(n=0;n<o.length;n++)document.getElementById(o[n]).onclick=function(e){return function(){E(e)}}(o[n]);q(),setInterval(q,.5)}window.addEventListener("load",M),n.d(t,"setup",function(){return M})}])});
//# sourceMappingURL=twizzle.js.map