!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("twisty"),require("puzzle-geometry"),require("alg"),require("kpuzzle")):"function"==typeof define&&define.amd?define(["twisty","puzzle-geometry","alg","kpuzzle"],t):"object"==typeof exports?exports.twizzle=t(require("twisty"),require("puzzle-geometry"),require("alg"),require("kpuzzle")):e.twizzle=t(e.twisty,e["puzzle-geometry"],e.alg,e.kpuzzle)}("undefined"!=typeof self?self:this,function(e,t,n,r){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t,n){"use strict";var r,o,i,s,l,a,u,c,d=n(0),f=n(1),p=n(2),m=n(3),v="",g="",y="",h=0,z=["threed","centers","edges","corners","centers","edges","corners","blockmoves","vertexmoves"],b=["centers","edges","corners","optimize","blockmoves","allmoves","vertexmoves","killori"];function w(e){return document.getElementById(e).checked}function k(e){for(var t={},n=0;n<e.length;n++)t[e[n]]=w(e[n]);return t}function x(){l.scrollLeft=l.scrollWidth,l.focus(),l.selectionStart=l.selectionEnd=1e8}function S(e){var t=document.getElementById("svg");if(!t||!e)return!1;e.stopPropagation(),e.preventDefault();var n=t.createSVGPoint();n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(t.getScreenCTM().inverse());for(var r=1e6,o=void 0,s=0;s<i.length;s++){var a=Math.hypot(i[s][0]-n.x,i[s][1]-n.y);a<r&&(r=a,o=s)}if(void 0!=o){var u=i[o][2];e.shiftKey?u=w("blockmoves")?u.toLowerCase():"2"+u:(e.ctrlKey||e.metaKey)&&c[u]&&(u=""+c[u]+u.toLowerCase()),function(e,t){try{var n=Object(p.parse)(l.value),r=Object(p.parse)(e);if(n instanceof p.Sequence&&r instanceof p.Sequence&&1==r.nestedUnits.length&&n.nestedUnits.length>0){var o=n.nestedUnits[n.nestedUnits.length-1],i=r.nestedUnits[0];if(o instanceof p.SiGNMove&&i instanceof p.SiGNMove&&o.family==i.family&&o.outerLayer==i.outerLayer&&o.innerLayer==i.innerLayer){var s=i.amount+o.amount,a=n.nestedUnits.slice();if(0==s||t>0&&s%t==0)a.length-=1;else{for(;s+s>t;)s-=t;for(;s+s<=-t;)s+=t;a[n.nestedUnits.length-1]=new p.SiGNMove(o.outerLayer,o.innerLayer,o.family,s)}return l.value=Object(p.algToString)(new p.Sequence(a)),x(),void I()}}}catch(e){}l.value+=" "+e,x(),I()}(u+(3==e.which?"":"'"),i[o][3])}return!1}function j(){var e=document.getElementById("svg");e&&!e.onclick&&(e.onclick=function(e){return S(e)}),e&&!e.oncontextmenu&&(e.oncontextmenu=function(e){return S(e)})}function P(e,t){return e.trim()==t.trim()}function O(e,t){var n;0==e.trim().length?(n=Object(p.parse)(o[0]+"60"),e=""):(n=Object(p.parse)(e),e=Object(p.algToString)(n));var i=document.querySelector("#custom-example");i&&(i.textContent="",new d.Twisty(i,{puzzle:r,alg:n}).anim.skipToEnd(),t&&(l.value=e,y=e))}function E(e){var t=window.open("","_blank");t&&(t.document.open("text/plain","replace"),t.document.write("<pre>"),e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),t.document.write(e),t.document.write("</pre>"),t.document.close())}function q(){var e=window.open("","_blank");if(e)return e.document.open("text/plain","replace"),e.document.write("<pre>"),function(t){t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),e&&e.document&&e.document.write(t+"\n")};throw"Could not open window"}function T(e){if("scramble"==e)return h=1,void I();if("reset"==e)return h=-1,void I();if("help"!=e){var t=[],n=k(b);n.allmoves&&t.push("allmoves",!0),n.vertexmoves&&t.push("vertexmoves",!0),n.corners||t.push("cornersets",!1),n.edges||t.push("edgesets",!1),n.centers||t.push("centersets",!1),n.optimize&&t.push("optimize",!0),n.blockmoves&&t.push("outerblockmoves",!0),n.killori&&t.push("killorientation",!0);var r=f.PuzzleGeometry.parsedesc(s.value),o=new f.PuzzleGeometry(r[0],r[1],t);if(o.allstickers(),o.genperms(),"gap"==e)E(o.writegap());else if("ss"==e){var i=q(),l=o.getOrbitsDef(!1).reassemblySize();i("Reassembly size is "+l),i("Ratio is "+l/f.SchreierSims.schreiersims(o.getMovesAsPerms(),i))}else"canon"==e?o.showcanon(q()):"ksolve"==e?E(o.writeksolve("TwizzlePuzzle",!1)):"svgcmd"==e?E(o.generatesvg(800,500,10,w("threed"))):alert("Command "+e+" not handled yet.")}else window.open("Help.html","Twizzle Help")}function I(){j();var e=s.value;if(null!=e){var t=l.value;if(null!=t){var n=k(z),a=function(e,t,n){for(var r=0;r<e.length;r++)if(t[e[r]]!=n[e[r]])return!1;return!0}(z,u,n);if(!(0==h&&P(e,g)&&P(t,y)&&a)){if(0!=h||g!=e||!a){var d=P(g,e);g=e,u=n;var p=f.PuzzleGeometry.parsedesc(e);if(p){var b=["allmoves",!0];u.corners||b.push("cornersets",!1),u.edges||b.push("edgesets",!1),u.centers||b.push("centersets",!1),0!=h&&(h>0&&b.push("scramble",1),h=0,t="",v="",d=!1);var w=new f.PuzzleGeometry(p[0],p[1],b);w.allstickers(),w.genperms();var x,S="Faces "+w.baseplanerot.length+"\nStickers per face "+w.stickersperface+"\nCubies "+w.cubies.length+"\nShort edge "+w.shortedge+"\nEdge distance "+w.edgedistance+"\nVertex distance "+w.vertexdistance,E=document.getElementById("data");E&&(E.title=S),a&&d&&""!=v?x=v:(x=w.writeksolve("TwizzlePuzzle",!0),o=w.ksolvemovenames);var q=w.generatesvg(800,500,10,u.threed);i=w.svggrips,function(e,t,n,o){v=t,r=Object(m.parse)(t);var i=e.movesetgeos,s=new m.KPuzzle(r);s.setFaceNames(e.facenames.map(e=>e[1])),c={};for(var l=0;l<i.length;l++){var a=i[l][0],u=i[l][2];s.addGrip(a,u,i[l][4]),c[a]=i[l][4],c[u]=i[l][4]}r.svg=n,o&&!P(y,"")?O(y,!0):O("",!0),j()}(w,x,q,d)}d||(y="",t=l.value)}if(!P(y,t)){y=t,l.style.backgroundColor="";var T="";if(T=t.trim().length>0?t:"",r)try{O(T,!1)}catch(e){return console.log("Could not parse "+T),void(l.style.backgroundColor="#ff8080")}}}}}}function L(e){var t=e.target.value;""!=t&&(a.selectedIndex=0,T(t))}function M(e){""!=e.target.value&&(s.value=e.target.value,I())}function C(){var e=document.getElementById("puzzleoptions");s=document.getElementById("desc"),l=document.getElementById("algorithm");var t=f.PuzzleGeometry.getpuzzles();u=k(z);for(var n=0;n<t.length;n+=2){var r=document.createElement("option");r.value=t[n],r.innerHTML=t[n+1],e.add(r)}e.onchange=M,(a=document.getElementById("action")).onchange=L;var o=["scramble","help","reset"];for(n=0;n<o.length;n++)document.getElementById(o[n]).onclick=function(e){return function(){T(e)}}(o[n]);I(),setInterval(I,.5)}window.addEventListener("load",C),n.d(t,"setup",function(){return C})}])});
//# sourceMappingURL=twizzle.js.map